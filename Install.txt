s3://support.elasticmapreduce/spark/install-spark

sudo useradd rhea
sudo passwd rhea

sudo yum install postgresql postgresql-server
sudo service postgresql initdb

sudo su postgres 
cd /var/lib/pgsql9/data
vim pg_hba.conf 
local   all         all                                  trust
host    all         all         0.0.0.0/0          md5

exit
sudo service postgresql start

mkdir data
scp -i /Users/rhea/rheahome/Spring2015/BDH8803/mykeypair.pem exact.sql hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/data

scp -i ~/rheahome/DVASpring15/HW3/cse6242-mkamath6-keypair.pem vocab.sql hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/data


sudo su postgres
createdb vocab
createdb exact
psql -d vocab

vocab=# CREATE USER rhea with password 'cuckoo99';
CREATE ROLE
vocab=# GRANT ALL PRIVILEGES ON DATABASE vocab to rhea;
GRANT
\q

psql -d exact
GRANT ALL PRIVILEGES ON DATABASE exact to rhea;
\q

exit

cd data
psql -d exact -f exact.sql -U rhea
psql -d vocab -f vocab.sql -U rhea

cd ../
mkdir code
scp -i /Users/rhea/rheahome/Spring2015/BDH8803/mykeypair.pem -r src hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/code
scp -i /Users/rhea/rheahome/Spring2015/BDH8803/mykeypair.pem -r sbt hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/code
scp -i /Users/rhea/rheahome/Spring2015/BDH8803/mykeypair.pem build.sbt hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/code
scp -i /Users/rhea/rheahome/Spring2015/BDH8803/mykeypair.pem project/build.properties hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/code/project
scp -i /Users/rhea/rheahome/Spring2015/BDH8803/mykeypair.pem project/plugins.sbt hadoop@ec2-54-68-123-95.us-west-2.compute.amazonaws.com:/home/hadoop/code/project

FOR EMR CLUSTER - POSTGRES:

place jar in /hadoop/code

change build sbt to use this jar version

change incoming port in security groups to accept 5432 on EMR cluster

sudo su - postgres
cd ..
cd pgsql9
cd data
vim postgresql.conf
listen_addresses = '*' 
port = 5432

vim pg_hba.conf
(1st part)
# IPv4 local connections:
host    all             all             0.0.0.0/0               md5

change host in application.conf in resource to use master's ip address

sudo service postgresql start -p 5432

./spark-submit --class edu.gatech.cse8803.main.Main --master yarn-client --driver-memory 5G --executor-memory 2G --jars /home/hadoop/code/postgresql-9.3-1103.jdbc41.jar /home/hadoop/code/target/scala-2.10/cse8803_project_template-assembly-1.0.jar



********extra******
mkdir temp_loc
sudo chown postgres temp_loc

CREATE TABLESPACE temp_disk2 LOCATION '/home/hadoop/temp_loc';
GRANT CREATE ON TABLESPACE temp_disk2 to rhea;

We then modify postgresql.conf to tell postgres to use this tablespace for temporary objects:

1
temp_tablespaces = 'ephemeral'
